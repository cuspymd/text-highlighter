<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>사용 가이드 - Marks: Text Highlighter</title>
    <link rel="stylesheet" href="guide.css">
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">Marks: Text Highlighter</div>
                <ul class="nav-links">
                    <li><a href="../index.html">홈</a></li>
                    <li><a href="../index.en.html">English</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="docs-container">
        <aside class="sidebar">
            <h3>목차</h3>
            <ul class="toc-list">
                <li><a href="#intro">소개</a></li>
                <li><a href="#add-highlights">하이라이트 추가</a>
                    <ul class="toc-sublist">
                        <li><a href="#add-control-ui">컨트롤 UI 이용</a></li>
                        <li><a href="#add-context-menu">우클릭 메뉴 이용</a></li>
                        <li><a href="#add-shortcuts">단축키 이용</a></li>
                    </ul>
                </li>
                <li><a href="#delete-highlights">하이라이트 삭제</a></li>
                <li><a href="#custom-colors">사용자 정의 색상</a></li>
                <li><a href="#minimap">미니맵</a></li>
                <li><a href="#popup-menu">Popup 메뉴 기능</a></li>
                <li><a href="#pages-list">하이라이트 목록 (Pages List)</a></li>
                <li><a href="#sync">동기화 기능</a></li>
                <li><a href="#import-export">가져오기 및 내보내기</a></li>
            </ul>
        </aside>

        <main class="content">
            <section id="intro">
                <h1>Marks: Text Highlighter 사용 가이드</h1>
                <p>Marks: Text Highlighter를 사용해 주셔서 감사합니다. 이 확장은 웹페이지의 텍스트를 쉽고 빠르게 하이라이트하고, 저장 및 관리할 수 있는 도구입니다.</p>
            </section>

            <section id="add-highlights">
                <h2>하이라이트 추가 방법</h2>
                <p>웹페이지에서 텍스트를 선택하여 하이라이트를 추가할 수 있는 세 가지 방법이 있습니다.</p>

                <h3 id="add-control-ui">1. 컨트롤 UI 이용 (모든 버전)</h3>
                <p>텍스트를 선택하면 선택 영역 근처에 하이라이트 아이콘(펜 모양)이 나타납니다. 이 아이콘을 클릭하거나 마우스를 올리면 색상 팔레트가 포함된 <strong>컨트롤 UI</strong>가 표시됩니다. 원하는 색상을 클릭하면 하이라이트가 적용됩니다.</p>
                <div class="note">
                    <span class="note-title">참고</span>
                    모바일 환경이나 설정에서 '텍스트 선택 시 컨트롤 UI 표시'가 켜져 있어야 작동합니다.
                </div>

                <h3 id="add-context-menu">2. 컨텍스트 메뉴 이용</h3>
                <p>텍스트를 선택한 후 마우스 오른쪽 버튼을 클릭하여 컨텍스트 메뉴를 엽니다. <strong>"Marks: Text Highlighter"</strong> 메뉴 하위에서 색상을 선택하여 하이라이트할 수 있습니다.</p>
                <div class="warning">
                    <span class="warning-title">제약 사항</span>
                    Firefox Android 버전에서는 컨텍스트 메뉴를 통한 하이라이트 추가가 지원되지 않습니다.
                </div>

                <h3 id="add-shortcuts">3. 단축키 사용</h3>
                <p>텍스트를 선택한 후 키보드 단축키를 눌러 빠르게 색상을 적용할 수 있습니다.</p>
                <ul>
                    <li><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>1</kbd> : 첫 번째 색상 (기본: 노란색)</li>
                    <li><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>2</kbd> : 두 번째 색상 (기본: 청록색)</li>
                    <li>... 숫자키 1~5까지 기본 색상에 대응됩니다.</li>
                </ul>
                <div class="warning">
                    <span class="warning-title">제약 사항</span>
                    Firefox Android 버전에서는 단축키 기능이 지원되지 않습니다.
                </div>
            </section>

            <section id="delete-highlights">
                <h2>하이라이트 삭제 방법</h2>
                <p>불필요한 하이라이트는 다음 방법으로 삭제할 수 있습니다.</p>
                <ul>
                    <li><strong>개별 삭제 (컨트롤 UI):</strong> 이미 하이라이트된 텍스트를 클릭하면 컨트롤 UI가 나타납니다. 여기서 <strong>휴지통 아이콘</strong>을 클릭하여 삭제합니다.</li>
                    <li><strong>개별 삭제 (Popup):</strong> 브라우저 툴바의 확장 아이콘을 눌러 Popup 메뉴를 엽니다. "현재 페이지 하이라이트" 목록에서 삭제하려는 항목 옆의 <strong>X 버튼</strong>을 누릅니다.</li>
                    <li><strong>페이지 내 전체 삭제 (Popup):</strong> Popup 메뉴 하단의 <strong>"모든 하이라이트 삭제"</strong> 버튼을 누르면 현재 보고 있는 페이지의 모든 하이라이트가 제거됩니다.</li>
                    <li><strong>페이지 단위 삭제 (Pages List):</strong> 하이라이트 목록 화면에서 특정 페이지 카드의 <strong>"삭제"</strong> 버튼을 누르면 해당 페이지의 모든 데이터가 삭제됩니다.</li>
                    <li><strong>모든 데이터 삭제 (Pages List):</strong> 하이라이트 목록 화면 상단의 <strong>휴지통 아이콘(모든 페이지 삭제)</strong>을 누르면 저장된 모든 하이라이트 데이터가 삭제됩니다.</li>
                </ul>
            </section>

            <section id="custom-colors">
                <h2>사용자 정의 색상 설정</h2>

                <h3>색상 추가 및 변경</h3>
                <p>기본 5가지 색상 외에 나만의 색상을 추가할 수 있습니다.</p>
                <ol>
                    <li>이미 하이라이트된 텍스트를 클릭하여 컨트롤 UI를 엽니다.</li>
                    <li>색상 목록 끝에 있는 <strong>+ 버튼</strong>을 클릭합니다.</li>
                    <li>색상 선택기에서 원하는 색상을 고르고 "적용"을 누릅니다.</li>
                </ol>
                <div class="note">
                    <span class="note-title">주의</span>
                    새로운 텍스트를 하이라이트할 때 나타나는 컨트롤 UI에는 + 버튼이 표시되지 않습니다. <strong>이미 생성된 하이라이트</strong>를 클릭했을 때만 색상 추가 버튼이 나타납니다.
                </div>

                <h3>색상 삭제</h3>
                <p>현재 개별 사용자 정의 색상 삭제 기능은 지원하지 않습니다. 모든 사용자 정의 색상을 초기화하려면 다음 방법을 사용하세요.</p>
                <ul>
                    <li>Popup 메뉴를 열고 <strong>"사용자 색상 삭제"</strong> 버튼을 클릭합니다. (기본 5가지 색상을 제외한 추가 색상이 모두 삭제됩니다.)</li>
                </ul>
            </section>

            <section id="minimap">
                <h2>미니맵 (Minimap)</h2>
                <p>하이라이트가 있는 웹페이지의 우측에는 <strong>미니맵</strong>이 표시됩니다.</p>
                <ul>
                    <li>미니맵은 페이지 전체 길이에서 하이라이트된 위치를 시각적으로 보여줍니다.</li>
                    <li>미니맵의 색상 마커를 클릭하면 해당 하이라이트 위치로 즉시 <strong>스크롤</strong>됩니다.</li>
                    <li>Popup 메뉴에서 "미니맵 표시" 스위치를 꺼서 숨길 수 있습니다.</li>
                </ul>
            </section>

            <section id="popup-menu">
                <h2>Popup 메뉴 설명</h2>
                <p>브라우저 툴바의 Marks 아이콘을 클릭하면 나타나는 메뉴입니다.</p>
                <ul>
                    <li><strong>현재 페이지 하이라이트:</strong> 현재 보고 있는 페이지에 저장된 하이라이트 목록을 보여줍니다. 클릭 시 해당 위치로 이동합니다.</li>
                    <li><strong>하이라이트 목록 (Highlighted Pages List):</strong> 저장된 모든 페이지를 관리하는 대시보드 화면을 엽니다.</li>
                    <li><strong>모든 하이라이트 삭제:</strong> 현재 페이지의 하이라이트를 모두 지웁니다.</li>
                    <li><strong>사용자 색상 삭제:</strong> 사용자가 추가한 커스텀 색상을 모두 지우고 기본 색상만 남깁니다.</li>
                    <li><strong>미니맵 표시:</strong> 페이지 우측 미니맵의 표시 여부를 설정합니다.</li>
                    <li><strong>텍스트 선택 시 컨트롤 UI 표시:</strong> 텍스트를 드래그했을 때 하이라이트 버튼이 자동으로 나타나는 기능을 켜고 끕니다.</li>
                </ul>
            </section>

            <section id="pages-list">
                <h2>하이라이트 목록 (Pages List) 화면</h2>
                <p>저장된 모든 하이라이트 정보를 한눈에 보고 관리할 수 있는 대시보드입니다.</p>
                <ul>
                    <li><strong>검색:</strong> 페이지 제목이나 URL로 저장된 기록을 검색할 수 있습니다.</li>
                    <li><strong>정렬:</strong> 최신순, 오래된순 등으로 목록을 정렬합니다.</li>
                    <li><strong>삭제:</strong> 개별 페이지를 삭제하거나, 상단 툴바의 삭제 버튼으로 전체 데이터를 초기화할 수 있습니다.</li>
                    <li><strong>내보내기/가져오기:</strong> 데이터를 백업하거나 복원할 수 있습니다.</li>
                </ul>
            </section>

            <section id="sync">
                <h2>동기화 (Synchronization)</h2>
                <p>로그인된 구글 계정(Chrome) 또는 Firefox 계정을 통해 여러 기기 간에 하이라이트 데이터를 동기화합니다.</p>

                <h3>동작 방식</h3>
                <p>한 기기에서 하이라이트를 추가하거나 삭제하면, 같은 계정으로 로그인된 다른 기기에도 자동으로 반영됩니다. 데이터 충돌 시 가장 최근에 수정된 내용이 유지됩니다.</p>

                <h3>제약 사항</h3>
                <ul>
                    <li><strong>용량 제한:</strong> 동기화 저장소는 <strong>총 100KB</strong>의 용량 제한이 있으며, 하이라이트 항목 하나당 <strong>8KB</strong>를 넘을 수 없습니다.</li>
                    <li><strong>오래된 데이터 정리:</strong> 용량이 가득 차면, 가장 오래전에 업데이트된 페이지의 동기화 데이터부터 자동으로 삭제됩니다. (로컬 데이터는 유지됩니다.)</li>
                    <li><strong>모바일 미지원:</strong> Firefox Android 버전에서는 동기화 기능이 지원되지 않습니다.</li>
                </ul>
            </section>

            <section id="import-export">
                <h2>가져오기 및 내보내기</h2>
                <p>데이터를 안전하게 백업하거나 다른 브라우저로 이동할 때 유용합니다.</p>
                <ul>
                    <li><strong>내보내기 (Export):</strong> 현재 저장된 모든 하이라이트 데이터를 JSON 파일로 다운로드합니다.</li>
                    <li><strong>가져오기 (Import):</strong> 이전에 내보낸 JSON 파일을 선택하여 데이터를 복원합니다.</li>
                </ul>
            </section>
        </main>
    </div>

    <!-- Active TOC Highlight Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    const id = entry.target.getAttribute('id');
                    if (entry.intersectionRatio > 0) {
                        document.querySelector(`.sidebar a[href="#${id}"]`)?.classList.add('active');
                    } else {
                        document.querySelector(`.sidebar a[href="#${id}"]`)?.classList.remove('active');
                    }
                });
            });

            // Track all sections that have an ID
            document.querySelectorAll('section[id]').forEach((section) => {
                observer.observe(section);
            });
        });
    </script>
</body>
</html>
